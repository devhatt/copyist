<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>Markdown to Canvas</title>
    <!-- Incluindo Highlight.js -->
    <link
      rel="stylesheet"
      href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/11.2.0/styles/default.min.css"
    />
    <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/11.2.0/highlight.min.js"></script>

    <!-- Incluindo Marked.js -->
    <script src="//cdn.jsdelivr.net/npm/marked/marked.min.js"></script>

    <!-- Incluindo html2canvas -->
    <script src="https://html2canvas.hertzen.com/dist/html2canvas.min.js"></script>
  </head>
  <body>
    <select id="fontSelector">
      <option value="Arial">Arial</option>
      <option value="Courier New">Courier New</option>
      <option value="Georgia">Georgia</option>
    </select>
    <textarea id="markdownInput" placeholder="Enter Markdown here"></textarea>
    <button onclick="convertMarkdownToCanvas()">Convert to Canvas</button>
    <canvas id="resultCanvas" width="1000" height="1000"></canvas>

    <script>
      function convertMarkdownToCanvas() {
        const markdownText = document.getElementById("markdownInput").value;
        const selectedFont = document.getElementById("fontSelector").value;
        const htmlContent = marked.parse(markdownText);

        // Criando um elemento temporário para renderizar o HTML
        const tempDiv = document.createElement("div");
        tempDiv.style.fontFamily = selectedFont; // Aplica a fonte selecionada
        tempDiv.innerHTML = htmlContent;
        document.body.appendChild(tempDiv);

        // Aplicando Highlight.js
        tempDiv.querySelectorAll("pre code").forEach((block) => {
          hljs.highlightBlock(block);
        });

        // Convertendo para Canvas com html2canvas
        html2canvas(tempDiv, { scale: 1, logging: true }).then((canvas) => {
          const resultCanvas = document.getElementById("resultCanvas");
          const ctx = resultCanvas.getContext("2d");
          ctx.clearRect(0, 0, resultCanvas.width, resultCanvas.height);
          ctx.drawImage(canvas, 0, 0);
          document.body.removeChild(tempDiv); // Remove o elemento temporário
        });
      }
    </script>
  </body>
</html>
